#######################################################
-net ./VGG_ImageNet_profall.net_sc -plat ABCI.plat -goal 1 --paratype ['df']
--cmaxB 262144.0 --cmaxp 1024.0 --cBon 32.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./VGG_ImageNet_profall.net_sc
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV1_1 	[3, 226, 226] = 153228 	[3, 64, 3, 3] = 1728 	[64, 226, 226] = 3268864 	0.008245589
1 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
2 CONV1_2 	[64, 226, 226] = 3268864 	[64, 64, 3, 3] = 36864 	[64, 226, 226] = 3268864 	0.0
3 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
4 MPOOL 	[64, 226, 226] = 3268864 	[0, 0, 2, 2] = 0 	[64, 113, 113] = 817216 	0.0
5 CONV2_1 	[64, 113, 113] = 817216 	[64, 128, 3, 3] = 73728 	[128, 113, 113] = 1634432 	0.0
6 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
7 CONV2_2 	[128, 113, 113] = 1634432 	[128, 128, 3, 3] = 147456 	[128, 113, 113] = 1634432 	0.0
8 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
9 MPOOL 	[128, 113, 113] = 1634432 	[0, 0, 2, 2] = 0 	[128, 57, 57] = 415872 	0.0
10 CONV3_1 	[128, 57, 57] = 415872 	[128, 256, 3, 3] = 294912 	[256, 57, 57] = 831744 	0.0
11 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
12 CONV3_2 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
13 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
14 CONV3_3 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
15 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
16 MPOOL 	[256, 57, 57] = 831744 	[0, 0, 2, 2] = 0 	[256, 29, 29] = 215296 	0.0
17 CONV4_1 	[256, 29, 29] = 215296 	[256, 512, 3, 3] = 1179648 	[512, 29, 29] = 430592 	0.0
18 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
19 CONV4_2 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
20 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
21 CONV4_3 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
22 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
23 MPOOL 	[512, 29, 29] = 430592 	[0, 0, 2, 2] = 0 	[512, 15, 15] = 115200 	0.0
24 CONV5_1 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
25 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
26 CONV5_2 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
27 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
28 CONV5_3 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
29 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
30 MPOOL 	[512, 15, 15] = 115200 	[0, 0, 2, 2] = 0 	[512, 8, 8] = 32768 	0.0
31 FC6 	[512, 8, 8] = 32768 	[512, 4096, 8, 8] = 134217728 	[4096, 1, 1] = 4096 	0.0
32 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
33 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
34 FC7 	[4096, 1, 1] = 4096 	[4096, 4096, 1, 1] = 16777216 	[4096, 1, 1] = 4096 	0.0
35 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
36 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
37 FC8 	[4096, 1, 1] = 4096 	[4096, 1000, 1, 1] = 4096000 	[1000, 1, 1] = 1000 	0.0
Model with 38 layers
Total |x|: 15705164 items
Total |y|: 15552936 items
Total |w|: 169801408 items
Total comp: 0.008245589 sec
Max comp: 0.008245589 sec ==>121.276963962samples for 100% GPU ultilization
Max |y|: 3268864 items
Layer config [1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
CONV1_1 	[3, 226, 226] 	[3, 64, 3, 3] 	[64, 226, 226] 	4.34765322602e-05
RELU 	[64, 226, 226] 	[64, 64, 0, 0] 	[64, 226, 226] 	8.05117027003e-07
CONV1_2 	[64, 226, 226] 	[64, 64, 3, 3] 	[64, 226, 226] 	0.000927499354885
RELU 	[64, 226, 226] 	[64, 64, 0, 0] 	[64, 226, 226] 	8.05117027003e-07
MPOOL 	[64, 226, 226] 	[0, 0, 2, 2] 	[64, 113, 113] 	5.15274897282e-05
CONV2_1 	[64, 113, 113] 	[64, 128, 3, 3] 	[128, 113, 113] 	0.00046375648711
RELU 	[128, 113, 113] 	[128, 128, 0, 0] 	[128, 113, 113] 	4.02558513501e-07
CONV2_2 	[128, 113, 113] 	[128, 128, 3, 3] 	[128, 113, 113] 	0.000927512974219
RELU 	[128, 113, 113] 	[128, 128, 0, 0] 	[128, 113, 113] 	4.02558513501e-07
MPOOL 	[128, 113, 113] 	[0, 0, 2, 2] 	[128, 57, 57] 	5.24435160551e-05
CONV3_1 	[128, 57, 57] 	[128, 256, 3, 3] 	[256, 57, 57] 	0.00047202796272
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	2.0485748459e-07
CONV3_2 	[256, 57, 57] 	[256, 256, 3, 3] 	[256, 57, 57] 	0.00094405592544
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	2.0485748459e-07
CONV3_3 	[256, 57, 57] 	[256, 256, 3, 3] 	[256, 57, 57] 	0.00094405592544
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	2.0485748459e-07
MPOOL 	[256, 57, 57] 	[0, 0, 2, 2] 	[256, 29, 29] 	5.42997808585e-05
CONV4_1 	[256, 29, 29] 	[256, 512, 3, 3] 	[512, 29, 29] 	0.000488843300624
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	1.06054259489e-07
CONV4_2 	[512, 29, 29] 	[512, 512, 3, 3] 	[512, 29, 29] 	0.000977686601249
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	1.06054259489e-07
CONV4_3 	[512, 29, 29] 	[512, 512, 3, 3] 	[512, 29, 29] 	0.000977686601249
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	1.06054259489e-07
MPOOL 	[512, 29, 29] 	[0, 0, 2, 2] 	[512, 15, 15] 	5.81091590638e-05
CONV5_1 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000261781761582
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	2.83736128241e-08
CONV5_2 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000261781761582
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	2.83736128241e-08
CONV5_3 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000261781761582
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	2.83736128241e-08
MPOOL 	[512, 15, 15] 	[0, 0, 2, 2] 	[512, 8, 8] 	1.6528827467e-05
FC6 	[512, 8, 8] 	[512, 4096, 8, 8] 	[4096, 1, 1] 	4.95864824011e-05
RELU 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	1.00883956708e-09
DROPOUT 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	0.0
FC7 	[4096, 1, 1] 	[4096, 4096, 1, 1] 	[4096, 1, 1] 	6.19831030014e-06
RELU 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	1.00883956708e-09
DROPOUT 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	0.0
FC8 	[4096, 1, 1] 	[4096, 1000, 1, 1] 	[1000, 1, 1] 	1.51325935062e-06
****
global value g GOAL 1
MAX_MINIBATCH 262144.0
MAX_RANK 1024.0
FIX_MIRCO_BATCH 32.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1280000.0
GPU_PER_NODE 4

{'maxOut': 3268864, 'totalOut': 15552936, 'minFilter': 64, 'minChannel': 64, 'totalIn': 15705164, 'totalComp': 0.008245589, 'totalWeight': 169801408, 'minW': 15}
==========DATA + FILTER PARALLELISM==========
Use FIX_MIRCO_BATCH set by user,  32.0
0.0730121212013
GPUDIRECT True
FILTER 0.081342792 9e-06 2e-11 55756800.0 32.0
GPUDIRECT True
DATA 0.0 9e-06 1.6e-10 679205632.0
ITER TIME: 4.0 40000.0 0.0730121212013 0.081342792 0.027114264 0.054228528 0.0
0.0730121212013
GPUDIRECT True
FILTER 0.081342792 9e-06 2e-11 55756800.0 64.0
GPUDIRECT True
DATA 0.43477222448 4.031e-05 6.4e-10 679205632.0
ITER TIME: 8.0 20000.0 0.0730121212013 0.51611501648 0.027114264 0.054228528 0.43477222448
0.0730121212013
GPUDIRECT True
FILTER 0.081342792 9e-06 2e-11 55756800.0 128.0
GPUDIRECT True
DATA 0.65227926672 4.031e-05 6.4e-10 679205632.0
ITER TIME: 16.0 10000.0 0.0730121212013 0.73362205872 0.027114264 0.054228528 0.65227926672
0.0730121212013
GPUDIRECT True
FILTER 0.081342792 9e-06 2e-11 55756800.0 256.0
GPUDIRECT True
DATA 0.76127464784 4.031e-05 6.4e-10 679205632.0
ITER TIME: 32.0 5000.0 0.0730121212013 0.84261743984 0.027114264 0.054228528 0.76127464784
0.0730121212013
GPUDIRECT True
FILTER 0.081342792 9e-06 2e-11 55756800.0 512.0
GPUDIRECT True
DATA 0.8162560584 4.031e-05 6.4e-10 679205632.0
ITER TIME: 64.0 2500.0 0.0730121212013 0.8975988504 0.027114264 0.054228528 0.8162560584
0.0730121212013
GPUDIRECT True
FILTER 0.081342792 9e-06 2e-11 55756800.0 1024.0
GPUDIRECT True
DATA 0.84472536368 4.049e-05 6.4e-10 679205632.0
ITER TIME: 128.0 1250.0 0.0730121212013 0.92606815568 0.027114264 0.054228528 0.84472536368
0.0730121212013
GPUDIRECT True
FILTER 0.081342792 9e-06 2e-11 55756800.0 2048.0
GPUDIRECT True
DATA 0.86096257632 4.098e-05 6.4e-10 679205632.0
ITER TIME: 256.0 625.0 0.0730121212013 0.94230536832 0.027114264 0.054228528 0.86096257632
0.0730121212013
GPUDIRECT True
FILTER 0.0814729404672 9e-06 2e-11 55756800.0 4096.0
GPUDIRECT True
DATA 0.874396872756 4.098e-05 6.4e-10 679205632.0
ITER TIME: 512.0 313.0 0.0730121212013 0.95434286464 0.0271431704648 0.0542863409296 0.87300007264
0.0730121212013
GPUDIRECT True
FILTER 0.0817332374016 9e-06 2e-11 55756800.0 8192.0
GPUDIRECT True
DATA 0.891144038308 4.098e-05 6.4e-10 679205632.0
ITER TIME: 1024.0 157.0 0.0730121212013 0.9682297728 0.0272298898593 0.0544597797186 0.8868869808
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
df		32.0	4.0	9272222080.0	2920.48484805	3253.71168	6174.19652805	412.0
df		64.0	8.0	9272222080.0	1460.24242403	10322.3003296	11782.5427536	1576.0
df		128.0	16.0	9272222080.0	730.121212013	7336.2205872	8066.34179921	2160.0
df		256.0	32.0	9272222080.0	365.060606007	4213.0871992	4578.14780521	2464.0
df		512.0	64.0	9272222080.0	182.530303003	2243.997126	2426.527429	2624.0
df		1024.0	128.0	9272222080.0	91.2651515017	1157.5851946	1248.8503461	2688.0
df		2048.0	256.0	9272222080.0	45.6325757508	588.9408552	634.573430951	2816.0
df		4096.0	512.0	9272222080.0	22.852793936	298.709316632	321.562110568	3072.0
df		8192.0	1024.0	9272222080.0	11.4629030286	152.01207433	163.474977358	3072.0
