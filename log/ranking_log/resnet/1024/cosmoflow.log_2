#######################################################
-net ./COSMOFLOW.net -plat ABCI.plat -goal 1 --paratype ['ds']
--cmaxB 262144.0 --cmaxp 64.0 --cBon 1.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./COSMOFLOW.net
====================================
DATASET:  CosmoFlow
DATASET SIZE:  1584.0
SAMPLE SIZE: 4x512x512x512 536870912
====================================
Model:  CosmoFlow
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV_1 	[4, 512, 512, 512] = 536870912 	[4, 16, 3, 3, 3] = 1728 	[16, 510, 510, 510] = 2122416000 	2.108143184
1 RELU 	[16, 510, 510, 510] = 2122416000 	[16, 16, 0, 0, 0] = 0 	[16, 510, 510, 510] = 2122416000 	0.0
2 APOOL 	[16, 510, 510, 510] = 2122416000 	[0, 0, 2, 2, 2] = 0 	[16, 255, 255, 255] = 265302000 	0.0
3 CONV_2 	[16, 255, 255, 255] = 265302000 	[16, 32, 3, 3, 3] = 13824 	[32, 253, 253, 253] = 518216864 	0.0
4 RELU 	[32, 253, 253, 253] = 518216864 	[32, 32, 0, 0, 0] = 0 	[32, 253, 253, 253] = 518216864 	0.0
5 APOOL 	[32, 253, 253, 253] = 518216864 	[0, 0, 2, 2, 2] = 0 	[32, 126, 126, 126] = 64012032 	0.0
6 CONV_3 	[32, 126, 126, 126] = 64012032 	[32, 64, 3, 3, 3] = 55296 	[64, 62, 62, 62] = 15252992 	0.0
7 RELU 	[64, 62, 62, 62] = 15252992 	[64, 64, 0, 0, 0] = 0 	[64, 62, 62, 62] = 15252992 	0.0
8 APOOL 	[64, 62, 62, 62] = 15252992 	[0, 0, 2, 2, 2] = 0 	[64, 31, 31, 31] = 1906624 	0.0
9 CONV_4 	[64, 31, 31, 31] = 1906624 	[64, 128, 3, 3, 3] = 221184 	[128, 29, 29, 29] = 3121792 	0.0
10 RELU 	[128, 29, 29, 29] = 3121792 	[128, 128, 0, 0, 0] = 0 	[128, 29, 29, 29] = 3121792 	0.0
11 APOOL 	[128, 29, 29, 29] = 3121792 	[0, 0, 2, 2, 2] = 0 	[128, 14, 14, 14] = 351232 	0.0
12 CONV_5 	[128, 14, 14, 14] = 351232 	[128, 256, 2, 2, 2] = 262144 	[256, 13, 13, 13] = 562432 	0.0
13 RELU 	[256, 13, 13, 13] = 562432 	[256, 256, 0, 0, 0] = 0 	[256, 13, 13, 13] = 562432 	0.0
14 APOOL 	[256, 13, 13, 13] = 562432 	[0, 0, 2, 2, 2] = 0 	[256, 6, 6, 6] = 55296 	0.0
15 CONV_6 	[256, 6, 6, 6] = 55296 	[256, 256, 2, 2, 2] = 524288 	[256, 5, 5, 5] = 32000 	0.0
16 RELU 	[256, 5, 5, 5] = 32000 	[256, 256, 0, 0, 0] = 0 	[256, 5, 5, 5] = 32000 	0.0
17 APOOL 	[256, 5, 5, 5] = 32000 	[0, 0, 2, 2, 2] = 0 	[256, 2, 2, 2] = 2048 	0.0
18 CONV_7 	[256, 2, 2, 2] = 2048 	[256, 128, 2, 2, 2] = 262144 	[128, 1, 1, 1] = 128 	0.0
19 RELU 	[128, 1, 1, 1] = 128 	[128, 128, 0, 0, 0] = 0 	[128, 1, 1, 1] = 128 	0.0
20 FC_1 	[128, 1, 1, 1] = 128 	[128, 2048, 1, 1, 1] = 262144 	[2048, 1, 1, 1] = 2048 	0.0
21 RELU 	[2048, 1, 1, 1] = 2048 	[2048, 2048, 0, 0, 0] = 0 	[2048, 1, 1, 1] = 2048 	0.0
22 FC_2 	[2048, 1, 1, 1] = 2048 	[2048, 256, 1, 1, 1] = 524288 	[256, 1, 1, 1] = 256 	0.0
23 RELU 	[256, 1, 1, 1] = 256 	[256, 256, 0, 0, 0] = 0 	[256, 1, 1, 1] = 256 	0.0
24 FC_3 	[256, 1, 1, 1] = 256 	[256, 4, 1, 1, 1] = 1024 	[4, 1, 1, 1] = 4 	0.0
Model with 25 layers
Total |x|: 3528104656 items
Total |y|: 2991233748 items
Total |w|: 2128064 items
Total comp: 2.108143184 sec
Max comp: 2.108143184 sec ==>0.474351081838samples for 100% GPU ultilization
Max |y|: 2122416000 items
Layer config [1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
====================================
Model:  CosmoFlow
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
CONV_1 	[4, 512, 512, 512] 	[4, 16, 3, 3, 3] 	[16, 510, 510, 510] 	0.967359508429
RELU 	[16, 510, 510, 510] 	[16, 16, 0, 0, 0] 	[16, 510, 510, 510] 	0.00447851623429
APOOL 	[16, 510, 510, 510] 	[0, 0, 2, 2, 2] 	[16, 255, 255, 255] 	0.0716562597486
CONV_2 	[16, 255, 255, 255] 	[16, 32, 3, 3, 3] 	[32, 253, 253, 253] 	0.9447761751
RELU 	[32, 253, 253, 253] 	[32, 32, 0, 0, 0] 	[32, 253, 253, 253] 	0.00109349092652
APOOL 	[32, 253, 253, 253] 	[0, 0, 2, 2, 2] 	[32, 126, 126, 126] 	0.0345784260354
CONV_3 	[32, 126, 126, 126] 	[32, 64, 3, 3, 3] 	[64, 62, 62, 62] 	0.0556164005289
RELU 	[64, 62, 62, 62] 	[64, 64, 0, 0, 0] 	[64, 62, 62, 62] 	3.21853832111e-05
APOOL 	[64, 62, 62, 62] 	[0, 0, 2, 2, 2] 	[64, 31, 31, 31] 	0.00205986452551
CONV_4 	[64, 31, 31, 31] 	[64, 128, 3, 3, 3] 	[128, 29, 29, 29] 	0.0227659506853
RELU 	[128, 29, 29, 29] 	[128, 128, 0, 0, 0] 	[128, 29, 29, 29] 	6.58730246665e-06
APOOL 	[128, 29, 29, 29] 	[0, 0, 2, 2, 2] 	[128, 14, 14, 14] 	0.000758922930819
CONV_5 	[128, 14, 14, 14] 	[128, 256, 2, 2, 2] 	[256, 13, 13, 13] 	0.002430821297
RELU 	[256, 13, 13, 13] 	[256, 256, 0, 0, 0] 	[256, 13, 13, 13] 	1.18678941484e-06
APOOL 	[256, 13, 13, 13] 	[0, 0, 2, 2, 2] 	[256, 6, 6, 6] 	0.00023896115606
CONV_6 	[256, 6, 6, 6] 	[256, 256, 2, 2, 2] 	[256, 5, 5, 5] 	0.00027712856293
RELU 	[256, 5, 5, 5] 	[256, 256, 0, 0, 0] 	[256, 5, 5, 5] 	6.75232939712e-08
APOOL 	[256, 5, 5, 5] 	[0, 0, 2, 2, 2] 	[256, 2, 2, 2] 	8.85041318739e-06
CONV_7 	[256, 2, 2, 2] 	[256, 128, 2, 2, 2] 	[128, 1, 1, 1] 	1.38287706053e-06
RELU 	[128, 1, 1, 1] 	[128, 128, 0, 0, 0] 	[128, 1, 1, 1] 	2.70093175885e-10
FC_1 	[128, 1, 1, 1] 	[128, 2048, 1, 1, 1] 	[2048, 1, 1, 1] 	8.29726236318e-07
RELU 	[2048, 1, 1, 1] 	[2048, 2048, 0, 0, 0] 	[2048, 1, 1, 1] 	4.32149081416e-09
FC_2 	[2048, 1, 1, 1] 	[2048, 256, 1, 1, 1] 	[256, 1, 1, 1] 	1.65945247264e-06
RELU 	[256, 1, 1, 1] 	[256, 256, 0, 0, 0] 	[256, 1, 1, 1] 	5.40186351769e-10
FC_3 	[256, 1, 1, 1] 	[256, 4, 1, 1, 1] 	[4, 1, 1, 1] 	3.24111811062e-09
****
global value g GOAL 1
MAX_MINIBATCH 262144.0
MAX_RANK 64.0
FIX_MIRCO_BATCH 1.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1584.0
GPU_PER_NODE 4

{'maxOut': 2122416000, 'totalOut': 2991233748, 'minFilter': 16, 'minChannel': 16, 'totalIn': 3528104656, 'totalComp': 2.108143184, 'totalWeight': 2128064, 'minW': 253}
==========DATA + SPATIAL PARALLELISM==========
CosmoFlow 3 253
max_rank 64.0
totalComp  0.554168696865 4
maxSamplePerNode: 0.266622834017
Use FIX_MIRCO_BATCH set by user,  1.0
4.0 0.554168696865 0.554168696865
GPUDIRECT False
Halo_FW 0 0.010194524 4194304.0 0.00300011 5e-10
Halo_FW 3 0.01016182 4161600.0 0.00300011 5e-10
Thalo 0.040712688
GPUDIRECT False
Allgather 0.786325626 2072867456.0 0.00300011 1.25e-10
All-to-All 0.786325626
GPUDIRECT 1
LOCAL Allreduce 0.00030936768 9e-06 2e-11
GPUDIRECT True
GLOBAL Allreduce 0.0 9e-06 4e-11
SUMARY 0.040712688 1.572651252 0.00030936768 1584.0 0.554168696865
1584.0 1.0 1584.0
ITER TIME: 4.0 1584.0 0.554168696865 1.61367330768 0.040712688 1.572651252 0.00030936768
totalComp  0.554168696865 4
maxSamplePerNode: 0.266622834017
Use FIX_MIRCO_BATCH set by user,  1.0
8.0 0.554168696865 0.554168696865
GPUDIRECT False
Halo_FW 0 0.010194524 4194304.0 0.00300011 5e-10
Halo_FW 3 0.01016182 4161600.0 0.00300011 5e-10
Thalo 0.040712688
GPUDIRECT False
Allgather 0.786325626 2072867456.0 0.00300011 1.25e-10
All-to-All 0.786325626
GPUDIRECT 1
LOCAL Allreduce 0.00030936768 9e-06 2e-11
GPUDIRECT True
GLOBAL Allreduce 0.00144258096 4.031e-05 1.6e-10
SUMARY 0.040712688 1.572651252 0.00175194864 792.0 0.554168696865
1584.0 2.0 792.0
ITER TIME: 8.0 792.0 0.554168696865 1.61511588864 0.040712688 1.572651252 0.00175194864
totalComp  0.554168696865 4
maxSamplePerNode: 0.266622834017
Use FIX_MIRCO_BATCH set by user,  1.0
16.0 0.554168696865 0.554168696865
GPUDIRECT False
Halo_FW 0 0.010194524 4194304.0 0.00300011 5e-10
Halo_FW 3 0.01016182 4161600.0 0.00300011 5e-10
Thalo 0.040712688
GPUDIRECT False
Allgather 0.786325626 2072867456.0 0.00300011 1.25e-10
All-to-All 0.786325626
GPUDIRECT 1
LOCAL Allreduce 0.00030936768 9e-06 2e-11
GPUDIRECT True
GLOBAL Allreduce 0.00228480144 4.031e-05 1.6e-10
SUMARY 0.040712688 1.572651252 0.00259416912 396.0 0.554168696865
1584.0 4.0 396.0
ITER TIME: 16.0 396.0 0.554168696865 1.61595810912 0.040712688 1.572651252 0.00259416912
totalComp  0.554168696865 4
maxSamplePerNode: 0.266622834017
Use FIX_MIRCO_BATCH set by user,  1.0
32.0 0.554168696865 0.554168696865
GPUDIRECT False
Halo_FW 0 0.010194524 4194304.0 0.00300011 5e-10
Halo_FW 3 0.01016182 4161600.0 0.00300011 5e-10
Thalo 0.040712688
GPUDIRECT False
Allgather 0.786325626 2072867456.0 0.00300011 1.25e-10
All-to-All 0.786325626
GPUDIRECT 1
LOCAL Allreduce 0.00030936768 9e-06 2e-11
GPUDIRECT True
GLOBAL Allreduce 0.00294777168 4.031e-05 1.6e-10
SUMARY 0.040712688 1.572651252 0.00325713936 198.0 0.554168696865
1584.0 8.0 198.0
ITER TIME: 32.0 198.0 0.554168696865 1.61662107936 0.040712688 1.572651252 0.00325713936
totalComp  0.554168696865 4
maxSamplePerNode: 0.266622834017
Use FIX_MIRCO_BATCH set by user,  1.0
64.0 0.554168696865 0.554168696865
GPUDIRECT False
Halo_FW 0 0.010194524 4194304.0 0.00300011 5e-10
Halo_FW 3 0.01016182 4161600.0 0.00300011 5e-10
Thalo 0.040712688
GPUDIRECT False
Allgather 0.786325626 2072867456.0 0.00300011 1.25e-10
All-to-All 0.786325626
GPUDIRECT 1
LOCAL Allreduce 0.00030936768 9e-06 2e-11
GPUDIRECT True
GLOBAL Allreduce 0.0037629768 4.031e-05 1.6e-10
SUMARY 0.040712688 1.572651252 0.00407234448 99.0 0.554168696865
1584.0 16.0 99.0
ITER TIME: 64.0 99.0 0.554168696865 1.61743628448 0.040712688 1.572651252 0.00407234448
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
ds		1.0	4.0	59963036064.0	877.803215834	2556.05851937	3433.8617352	232.0
ds		2.0	8.0	59963036064.0	438.901607917	1279.1717838	1718.07339172	232.0
ds		4.0	16.0	59963036064.0	219.450803959	639.919411212	859.37021517	240.0
ds		8.0	32.0	59963036064.0	109.725401979	320.090973713	429.816375693	256.0
ds		16.0	64.0	59963036064.0	54.8627009896	160.126192164	214.988893153	256.0
