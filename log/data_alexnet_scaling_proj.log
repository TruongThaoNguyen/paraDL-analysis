#######################################################
-net ./ALEXNET_ImageNet_profall.net_sc -plat ABCI.plat -goal 1 --paratype ['o', 'd']
--cmaxB 2000000.0 --cmaxp 2048.0 --cBon 512.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./ALEXNET_ImageNet_profall.net_sc
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  AlexNet
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV1 	[3, 226, 226] = 153228 	[3, 96, 11, 11] = 34848 	[96, 54, 54] = 279936 	0.000610938
1 RELU 	[96, 54, 54] = 279936 	[96, 96, 0, 0] = 0 	[96, 54, 54] = 279936 	0.0
2 MPOOL 	[96, 54, 54] = 279936 	[0, 0, 3, 3] = 0 	[96, 27, 27] = 69984 	0.0
3 CONV2 	[96, 27, 27] = 69984 	[96, 256, 5, 5] = 614400 	[256, 27, 27] = 186624 	0.0
4 RELU 	[256, 27, 27] = 186624 	[256, 256, 0, 0] = 0 	[256, 27, 27] = 186624 	0.0
5 MPOOL 	[256, 27, 27] = 186624 	[0, 0, 3, 3] = 0 	[256, 13, 13] = 43264 	0.0
6 CONV3 	[256, 13, 13] = 43264 	[256, 384, 3, 3] = 884736 	[384, 13, 13] = 64896 	0.0
7 RELU 	[384, 13, 13] = 64896 	[384, 384, 0, 0] = 0 	[384, 13, 13] = 64896 	0.0
8 CONV4 	[384, 13, 13] = 64896 	[384, 384, 3, 3] = 1327104 	[384, 13, 13] = 64896 	0.0
9 RELU 	[384, 13, 13] = 64896 	[384, 384, 0, 0] = 0 	[384, 13, 13] = 64896 	0.0
10 CONV5 	[384, 13, 13] = 64896 	[384, 256, 3, 3] = 884736 	[256, 13, 13] = 43264 	0.0
11 RELU 	[256, 13, 13] = 43264 	[256, 256, 0, 0] = 0 	[256, 13, 13] = 43264 	0.0
12 MPOOL 	[256, 13, 13] = 43264 	[0, 0, 3, 3] = 0 	[256, 6, 6] = 9216 	0.0
13 FC6 	[256, 6, 6] = 9216 	[256, 4096, 6, 6] = 37748736 	[4096, 1, 1] = 4096 	0.0
14 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
15 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
16 FC7 	[4096, 1, 1] = 4096 	[4096, 4096, 1, 1] = 16777216 	[4096, 1, 1] = 4096 	0.0
17 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
18 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
19 FC8 	[4096, 1, 1] = 4096 	[4096, 1000, 1, 1] = 4096000 	[1000, 1, 1] = 1000 	0.0
Model with 20 layers
Total |x|: 931692 items
Total |y|: 779464 items
Total |w|: 62367776 items
Total comp: 0.000610938 sec
Max comp: 0.000610938 sec ==>1636.8273049samples for 100% GPU ultilization
Max |y|: 279936 items
Layer config [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
====================================
Model:  AlexNet
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
CONV1 	[3, 226, 226] 	[3, 96, 11, 11] 	[96, 54, 54] 	5.1364413464e-05
RELU 	[96, 54, 54] 	[96, 96, 0, 0] 	[96, 54, 54] 	7.07438156624e-08
MPOOL 	[96, 54, 54] 	[0, 0, 3, 3] 	[96, 27, 27] 	1.52806641831e-05
CONV2 	[96, 27, 27] 	[96, 256, 5, 5] 	[256, 27, 27] 	0.000226457843937
RELU 	[256, 27, 27] 	[256, 256, 0, 0] 	[256, 27, 27] 	4.7162543775e-08
MPOOL 	[256, 27, 27] 	[0, 0, 3, 3] 	[256, 13, 13] 	2.51906209121e-05
CONV3 	[256, 13, 13] 	[256, 384, 3, 3] 	[384, 13, 13] 	7.56836554327e-05
RELU 	[384, 13, 13] 	[384, 384, 0, 0] 	[384, 13, 13] 	1.6400143823e-08
CONV4 	[384, 13, 13] 	[384, 384, 3, 3] 	[384, 13, 13] 	0.000113525483149
RELU 	[384, 13, 13] 	[384, 384, 0, 0] 	[384, 13, 13] 	1.6400143823e-08
CONV5 	[384, 13, 13] 	[384, 256, 3, 3] 	[256, 13, 13] 	7.56836554327e-05
RELU 	[256, 13, 13] 	[256, 256, 0, 0] 	[256, 13, 13] 	1.09334292153e-08
MPOOL 	[256, 13, 13] 	[0, 0, 3, 3] 	[256, 6, 6] 	5.36604942506e-06
FC6 	[256, 6, 6] 	[256, 4096, 6, 6] 	[4096, 1, 1] 	1.43094651335e-05
RELU 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	1.03511755885e-09
DROPOUT 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	0.0
FC7 	[4096, 1, 1] 	[4096, 4096, 1, 1] 	[4096, 1, 1] 	6.35976228156e-06
RELU 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	1.03511755885e-09
DROPOUT 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	0.0
FC8 	[4096, 1, 1] 	[4096, 1000, 1, 1] 	[1000, 1, 1] 	1.55267633827e-06
****
global value g GOAL 1
MAX_MINIBATCH 2000000.0
MAX_RANK 2048.0
FIX_MIRCO_BATCH 512.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1280000.0
GPU_PER_NODE 4

{'maxOut': 279936, 'totalOut': 779464, 'minFilter': 96, 'minChannel': 96, 'totalIn': 931692, 'totalComp': 0.000610938, 'totalWeight': 62367776, 'minW': 1}
==========SINGLE-NODE===============
maxSamplePerNode: 1132.35276269
Use FIX_MIRCO_BATCH set by user for miniBatch:  512.0
==========DATA PARALLELISM==========
maxSamplePerNode: 1132.35276269
Use FIX_MIRCO_BATCH set by user,  512.0
2.0 9e-06 1e-11 249471104.0 9e-06 0.00124735552 0.00125635552 0.000125185552
4.0 9e-06 1e-11 249471104.0 2.7e-05 0.00187103328 0.00189803328 0.000188453328
8.0 3.031e-05 4e-11 249471104.0 0.00021217 0.00873148864 0.00894365864 0.000883757364
16.0 3.031e-05 4e-11 249471104.0 0.00045465 0.0093551664 0.0098098164 0.00095824914
32.0 3.031e-05 4e-11 249471104.0 0.00093961 0.00966700528 0.01060661528 0.001013681028
64.0 3.031e-05 4e-11 249471104.0 0.00190953 0.00982292472 0.01173245472 0.001077768972
128.0 3.049e-05 4e-11 249471104.0 0.00387223 0.00990088444 0.01377311444 0.001183699944
256.0 3.098e-05 4e-11 249471104.0 0.0078999 0.0099398643 0.0178397643 0.00138898143
512.0 3.098e-05 4e-11 249471104.0 0.01583078 0.00995935423 0.02579013423 0.001787474423
1024.0 3.098e-05 4e-11 249471104.0 0.03169254 0.009969099195 0.041661639195 0.0025815369195
2048.0 3.098e-05 4e-11 249471104.0 0.06341606 0.0099739716775 0.0733900316775 0.00416820016775
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
single		512.0	1	7507837184.0	782.00064	0	782.00064	14.0
data		1024.0	2.0	7507837184.0	391.00032	6.2592776	397.2595976	14.0
data		2048.0	4.0	7507837184.0	195.50016	4.7113332	200.2114932	16.0
data		4096.0	8.0	7507837184.0	97.75008	11.0646421973	108.814722197	16.0
data		8192.0	16.0	7507837184.0	48.87504	6.0178045992	54.8928445992	16.0
data		16384.0	32.0	7507837184.0	24.43752	3.20323204848	27.6407520485	32.0
data		32768.0	64.0	7507837184.0	12.21876	1.7244303552	13.9431903552	64.0
data		65536.0	128.0	7507837184.0	6.10938	0.9469599552	7.0563399552	128.0
data		131072.0	256.0	7507837184.0	3.05469	0.555592572	3.610282572	256.0
data		262144.0	512.0	7507837184.0	1.527345	0.3574948846	1.8848398846	512.0
data		524288.0	1024.0	7507837184.0	0.7636725	0.30978443034	1.07345693034	1024.0
data		1048576.0	2048.0	7507837184.0	0.38183625	0.33345601342	0.71529226342	2048.0
