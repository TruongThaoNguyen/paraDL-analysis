#######################################################
-net ./VGG_ImageNet_profall.net_sc -plat ABCI.plat -goal 1 --paratype ['o', 'd']
--cmaxB 262144.0 --cmaxp 2048.0 --cBon 32.0
====================================
Read platform from  ABCI.plat
====================================
FILE:  ABCI.plat
MEM_PER_NODE:  16000000000.0
NODE_SPEED:  7.8e+12
BANDWIDTH:  12500000000.0
LATENCY:  5e-07
MAX_NODE:  4096.0
====================================
Read dataset and DNN from  ./VGG_ImageNet_profall.net_sc
====================================
DATASET:  ImageNet
DATASET SIZE:  1280000.0
SAMPLE SIZE: 3x226x226 153228
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
0 CONV1_1 	[3, 226, 226] = 153228 	[3, 64, 3, 3] = 1728 	[64, 226, 226] = 3268864 	0.008245589
1 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
2 CONV1_2 	[64, 226, 226] = 3268864 	[64, 64, 3, 3] = 36864 	[64, 226, 226] = 3268864 	0.0
3 RELU 	[64, 226, 226] = 3268864 	[64, 64, 0, 0] = 0 	[64, 226, 226] = 3268864 	0.0
4 MPOOL 	[64, 226, 226] = 3268864 	[0, 0, 2, 2] = 0 	[64, 113, 113] = 817216 	0.0
5 CONV2_1 	[64, 113, 113] = 817216 	[64, 128, 3, 3] = 73728 	[128, 113, 113] = 1634432 	0.0
6 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
7 CONV2_2 	[128, 113, 113] = 1634432 	[128, 128, 3, 3] = 147456 	[128, 113, 113] = 1634432 	0.0
8 RELU 	[128, 113, 113] = 1634432 	[128, 128, 0, 0] = 0 	[128, 113, 113] = 1634432 	0.0
9 MPOOL 	[128, 113, 113] = 1634432 	[0, 0, 2, 2] = 0 	[128, 57, 57] = 415872 	0.0
10 CONV3_1 	[128, 57, 57] = 415872 	[128, 256, 3, 3] = 294912 	[256, 57, 57] = 831744 	0.0
11 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
12 CONV3_2 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
13 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
14 CONV3_3 	[256, 57, 57] = 831744 	[256, 256, 3, 3] = 589824 	[256, 57, 57] = 831744 	0.0
15 RELU 	[256, 57, 57] = 831744 	[256, 256, 0, 0] = 0 	[256, 57, 57] = 831744 	0.0
16 MPOOL 	[256, 57, 57] = 831744 	[0, 0, 2, 2] = 0 	[256, 29, 29] = 215296 	0.0
17 CONV4_1 	[256, 29, 29] = 215296 	[256, 512, 3, 3] = 1179648 	[512, 29, 29] = 430592 	0.0
18 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
19 CONV4_2 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
20 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
21 CONV4_3 	[512, 29, 29] = 430592 	[512, 512, 3, 3] = 2359296 	[512, 29, 29] = 430592 	0.0
22 RELU 	[512, 29, 29] = 430592 	[512, 512, 0, 0] = 0 	[512, 29, 29] = 430592 	0.0
23 MPOOL 	[512, 29, 29] = 430592 	[0, 0, 2, 2] = 0 	[512, 15, 15] = 115200 	0.0
24 CONV5_1 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
25 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
26 CONV5_2 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
27 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
28 CONV5_3 	[512, 15, 15] = 115200 	[512, 512, 3, 3] = 2359296 	[512, 15, 15] = 115200 	0.0
29 RELU 	[512, 15, 15] = 115200 	[512, 512, 0, 0] = 0 	[512, 15, 15] = 115200 	0.0
30 MPOOL 	[512, 15, 15] = 115200 	[0, 0, 2, 2] = 0 	[512, 8, 8] = 32768 	0.0
31 FC6 	[512, 8, 8] = 32768 	[512, 4096, 8, 8] = 134217728 	[4096, 1, 1] = 4096 	0.0
32 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
33 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
34 FC7 	[4096, 1, 1] = 4096 	[4096, 4096, 1, 1] = 16777216 	[4096, 1, 1] = 4096 	0.0
35 RELU 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
36 DROPOUT 	[4096, 1, 1] = 4096 	[4096, 4096, 0, 0] = 0 	[4096, 1, 1] = 4096 	0.0
37 FC8 	[4096, 1, 1] = 4096 	[4096, 1000, 1, 1] = 4096000 	[1000, 1, 1] = 1000 	0.0
Model with 38 layers
Total |x|: 15705164 items
Total |y|: 15552936 items
Total |w|: 169801408 items
Total comp: 0.008245589 sec
Max comp: 0.008245589 sec ==>121.276963962samples for 100% GPU ultilization
Max |y|: 3268864 items
Layer config [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
====================================
Model:  VGG16
LAYER	 x[C,W,H] 	 w[C,F,K,K] 	 y[F,W,H] 	 TComp
CONV1_1 	[3, 226, 226] 	[3, 64, 3, 3] 	[64, 226, 226] 	4.34765322602e-05
RELU 	[64, 226, 226] 	[64, 64, 0, 0] 	[64, 226, 226] 	8.05117027003e-07
CONV1_2 	[64, 226, 226] 	[64, 64, 3, 3] 	[64, 226, 226] 	0.000927499354885
RELU 	[64, 226, 226] 	[64, 64, 0, 0] 	[64, 226, 226] 	8.05117027003e-07
MPOOL 	[64, 226, 226] 	[0, 0, 2, 2] 	[64, 113, 113] 	5.15274897282e-05
CONV2_1 	[64, 113, 113] 	[64, 128, 3, 3] 	[128, 113, 113] 	0.00046375648711
RELU 	[128, 113, 113] 	[128, 128, 0, 0] 	[128, 113, 113] 	4.02558513501e-07
CONV2_2 	[128, 113, 113] 	[128, 128, 3, 3] 	[128, 113, 113] 	0.000927512974219
RELU 	[128, 113, 113] 	[128, 128, 0, 0] 	[128, 113, 113] 	4.02558513501e-07
MPOOL 	[128, 113, 113] 	[0, 0, 2, 2] 	[128, 57, 57] 	5.24435160551e-05
CONV3_1 	[128, 57, 57] 	[128, 256, 3, 3] 	[256, 57, 57] 	0.00047202796272
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	2.0485748459e-07
CONV3_2 	[256, 57, 57] 	[256, 256, 3, 3] 	[256, 57, 57] 	0.00094405592544
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	2.0485748459e-07
CONV3_3 	[256, 57, 57] 	[256, 256, 3, 3] 	[256, 57, 57] 	0.00094405592544
RELU 	[256, 57, 57] 	[256, 256, 0, 0] 	[256, 57, 57] 	2.0485748459e-07
MPOOL 	[256, 57, 57] 	[0, 0, 2, 2] 	[256, 29, 29] 	5.42997808585e-05
CONV4_1 	[256, 29, 29] 	[256, 512, 3, 3] 	[512, 29, 29] 	0.000488843300624
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	1.06054259489e-07
CONV4_2 	[512, 29, 29] 	[512, 512, 3, 3] 	[512, 29, 29] 	0.000977686601249
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	1.06054259489e-07
CONV4_3 	[512, 29, 29] 	[512, 512, 3, 3] 	[512, 29, 29] 	0.000977686601249
RELU 	[512, 29, 29] 	[512, 512, 0, 0] 	[512, 29, 29] 	1.06054259489e-07
MPOOL 	[512, 29, 29] 	[0, 0, 2, 2] 	[512, 15, 15] 	5.81091590638e-05
CONV5_1 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000261781761582
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	2.83736128241e-08
CONV5_2 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000261781761582
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	2.83736128241e-08
CONV5_3 	[512, 15, 15] 	[512, 512, 3, 3] 	[512, 15, 15] 	0.000261781761582
RELU 	[512, 15, 15] 	[512, 512, 0, 0] 	[512, 15, 15] 	2.83736128241e-08
MPOOL 	[512, 15, 15] 	[0, 0, 2, 2] 	[512, 8, 8] 	1.6528827467e-05
FC6 	[512, 8, 8] 	[512, 4096, 8, 8] 	[4096, 1, 1] 	4.95864824011e-05
RELU 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	1.00883956708e-09
DROPOUT 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	0.0
FC7 	[4096, 1, 1] 	[4096, 4096, 1, 1] 	[4096, 1, 1] 	6.19831030014e-06
RELU 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	1.00883956708e-09
DROPOUT 	[4096, 1, 1] 	[4096, 4096, 0, 0] 	[4096, 1, 1] 	0.0
FC8 	[4096, 1, 1] 	[4096, 1000, 1, 1] 	[1000, 1, 1] 	1.51325935062e-06
****
global value g GOAL 1
MAX_MINIBATCH 262144.0
MAX_RANK 2048.0
FIX_MIRCO_BATCH 32.0
NODE_SPEED 7.8e+12
MEM_PER_NODE 16000000000.0
ITEM_PER_NODE 4000000000.0
BW_FACTOR 8e-11
LATENCY_FACTOR 5e-07
TOTAL_SAMPLE 1280000.0
GPU_PER_NODE 4

{'maxOut': 3268864, 'totalOut': 15552936, 'minFilter': 64, 'minChannel': 64, 'totalIn': 15705164, 'totalComp': 0.008245589, 'totalWeight': 169801408, 'minW': 1}
==========SINGLE-NODE===============
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user for miniBatch:  32.0
==========DATA PARALLELISM==========
maxSamplePerNode: 58.5511784785
Use FIX_MIRCO_BATCH set by user,  32.0
2.0 9e-06 1e-11 679205632.0 9e-06 0.00339602816 0.00340502816 0.000340052816
4.0 9e-06 1e-11 679205632.0 2.7e-05 0.00509404224 0.00512104224 0.000510754224
8.0 3.031e-05 4e-11 679205632.0 0.00021217 0.02377219712 0.02398436712 0.002387828212
16.0 3.031e-05 4e-11 679205632.0 0.00045465 0.0254702112 0.0259248612 0.00256975362
32.0 3.031e-05 4e-11 679205632.0 0.00093961 0.02631921824 0.02725882824 0.002678902324
64.0 3.031e-05 4e-11 679205632.0 0.00190953 0.02674372176 0.02865325176 0.002769848676
128.0 3.049e-05 4e-11 679205632.0 0.00387223 0.02695597352 0.03082820352 0.002889208852
256.0 3.098e-05 4e-11 679205632.0 0.0078999 0.0270620994 0.0349619994 0.00310120494
512.0 3.098e-05 4e-11 679205632.0 0.01583078 0.02711516234 0.04294594234 0.003503055234
1024.0 3.098e-05 4e-11 679205632.0 0.03169254 0.02714169381 0.05883423381 0.004298796381
2048.0 3.098e-05 4e-11 679205632.0 0.06341606 0.027154959545 0.090571019545 0.0058862989545
==================SUMMARY==================
name		B	p	Mem (bytes)	Tcomp (s)	Tcomm(s)	Time(s)	Cost(min*Node)
single		32.0	1	9360484864.0	10554.35392	0	10554.35392	176.0
data		64.0	2.0	9360484864.0	5277.17696	272.0422528	5549.2192128	186.0
data		128.0	4.0	9360484864.0	2638.58848	204.3016896	2842.8901696	192.0
data		256.0	8.0	9360484864.0	1319.29424	477.5656424	1796.8598824	240.0
data		512.0	16.0	9360484864.0	659.64712	256.975362	916.622482	256.0
data		1024.0	32.0	9360484864.0	329.82356	133.9451162	463.7686762	256.0
data		2048.0	64.0	9360484864.0	164.91178	69.2462169	234.1579969	256.0
data		4096.0	128.0	9360484864.0	82.45589	36.172894827	118.628784827	256.0
data		8192.0	256.0	9360484864.0	41.227945	19.4755670232	60.7035120232	512.0
data		16384.0	512.0	9360484864.0	20.6139725	11.0696545394	31.6836270394	512.0
data		32768.0	1024.0	9360484864.0	10.30698625	6.8780742096	17.1850604596	1024.0
data		65536.0	2048.0	9360484864.0	5.153493125	4.7090391636	9.8625322886	2048.0
